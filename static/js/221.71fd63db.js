(self["webpackChunkMSC"]=self["webpackChunkMSC"]||[]).push([[221],{4648:function(a,e,t){"use strict";t.r(e)},6939:function(a,e,t){t(1808),t(1489),t(8963),t(4648)},9221:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return E}});t(4114);var l=t(641),s=t(33),n=t(953),c=t(7043),o=(t(6939),t(216),t(8982)),i=t(1368),r=t(31),u=t(2141);const v={class:"detail"},d={class:"app-head"},k={class:"head-left"},f={class:"content"},p={class:"value-info"},m={class:"section-top"},L={class:"section-bottom"},C={class:"value"},g={class:"amount"},h={class:"rest"},w={class:"amount"},_={class:"rest"},y={class:"amount"},b={class:"team-achievement"},K={class:"top"},R={class:"list van-list"},F={class:"cell"},T={class:"name"},V={class:"time"},x={class:"status"},W={class:"usdt"};var I=Object.assign({name:"property"},{__name:"team",setup(a){var e=t(5093);const I=(0,c.rd)(),S=((0,n.KR)([]),(0,n.KR)(!1)),A=(0,n.KR)(!1),E=(0,n.Kh)({}),M=(0,n.KR)([]),Y=((0,n.KR)(!1),(0,n.Kh)(i.n)),$=(0,n.KR)(null),H=(0,n.KR)(!1),O=(0,n.KR)("");(0,l.sV)(async()=>{await q(),await U(),await X(),Z()});const U=async()=>{const a=r.b(O.value);let e=await $.value.readContract("star","getUserVip",[a]);E.vip=e[3];await $.value.readContract("star","balanceOf",[a]);E.teamTotalInvestValue=(parseFloat(u.ck(e[0]))-parseFloat(u.ck(e[2]))).toFixed(4);let t=await $.value.readContract("star","getReferralCount",[a]);E.refferCount=t;let l=await $.value.readContract("star","teamTotalCount",[a]);E.teamTotalCount=l;let s=await $.value.readContract("star","getReferral",[a]);E.parentAddress=s},X=async()=>{const a=r.b(O.value);let t=await $.value.readContract("star","getReferrals",[a]);console.log(t);for(let l=0;l<t.length;l++){let a=t[l];const s=r.b(a);await $.value.readContract("star","balanceOf",[s]);let n=await $.value.readContract("star","joinTime",[s]),c=e(1e3*n.toString()).format("YYYY-MM-DD HH:mm:ss"),o=await $.value.readContract("star","getUserVip",[s]),i=await $.value.readContract("star","teamTotalInvestValue",[s]);M.value.push({address:a,createTime:c,vip:j(o[3]),total:parseFloat(u.ck(i)).toFixed(0)})}},j=a=>0==a?"普通用户":"V"+a,D=()=>{I.push("/qrcode")},N=()=>{I.push("/util")},q=async()=>{if($.value){const a=await $.value.getWalletState();a.isConnected?O.value=a.account:await B()}},B=async()=>{H.value=!0;try{if($.value){const a=await $.value.connectWallet();O.value=a}}catch(a){console.error("连接钱包失败：",a)}finally{H.value=!1}},z=a=>{O.value=a.account},G=({key:a,contract:e})=>{console.log(a,"合约初始化成功：",e.target)},J=({contractKey:a,methodName:e,receipt:t})=>{console.log(`交易成功：${e}`,t)},P=({scene:a,error:e})=>{console.error(`区块链错误[${a}]：`,e)},Q=a=>a?`${a.slice(0,6)}...${a.slice(-4)}`:"",Z=()=>{const a=document.getElementsByClassName("van-list");if(a.length>0){const e=document.body.clientHeight;a[0].style.height=e-a[0].offsetTop-8-56+"px"}};return(a,e)=>{const t=(0,l.g2)("el-tag"),n=(0,l.g2)("van-cell"),c=(0,l.g2)("van-list");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",v,[(0,l.Lk)("div",d,[(0,l.Lk)("span",k,(0,s.v_)(Q(O.value)),1),(0,l.Lk)("span",{class:"title team",onClick:N},"我的团队")]),(0,l.Lk)("div",f,[(0,l.Lk)("section",p,[(0,l.Lk)("div",m,[(0,l.Lk)("span",null,(0,s.v_)(j(E.vip)),1),(0,l.Lk)("span",{class:"promotion",onClick:D},"推广")]),e[6]||(e[6]=(0,l.Lk)("div",{class:"line"},null,-1)),(0,l.Lk)("div",L,[(0,l.Lk)("div",C,[(0,l.Lk)("div",g,(0,s.v_)(E.refferCount),1),e[1]||(e[1]=(0,l.Lk)("div",null,"直属节点",-1))]),e[4]||(e[4]=(0,l.Lk)("div",{class:"vertical-line"},null,-1)),(0,l.Lk)("div",h,[(0,l.Lk)("div",w,(0,s.v_)(E.teamTotalCount),1),e[2]||(e[2]=(0,l.Lk)("div",null,"节点总组数",-1))]),e[5]||(e[5]=(0,l.Lk)("div",{class:"vertical-line"},null,-1)),(0,l.Lk)("div",_,[(0,l.Lk)("div",y,(0,s.v_)(parseFloat(E.teamTotalInvestValue).toFixed(0)),1),e[3]||(e[3]=(0,l.Lk)("div",null,"小区总算力",-1))])])]),(0,l.Lk)("div",b,[(0,l.Lk)("div",K,[e[7]||(e[7]=(0,l.Lk)("div",null,"上级地址",-1)),(0,l.Lk)("div",null,(0,s.v_)(Q(E.parentAddress)),1)])]),e[8]||(e[8]=(0,l.Lk)("section",{class:"title"},"团队节点分布",-1)),(0,l.Lk)("div",R,[(0,l.bF)(c,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),finished:A.value,"finished-text":"没有更多了"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(M.value,(a,e)=>((0,l.uX)(),(0,l.Wv)(n,{border:!1,key:e},{default:(0,l.k6)(()=>[(0,l.Lk)("div",F,[(0,l.Lk)("div",T,[(0,l.eW)((0,s.v_)(Q(a.address))+" ",1),(0,l.Lk)("div",V,(0,s.v_)(a.createTime),1),(0,l.Lk)("span",x,[(0,l.bF)(t,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(a.vip),1)]),_:2},1024)])]),(0,l.Lk)("div",null,[(0,l.Lk)("div",W,(0,s.v_)(a.total),1)])])]),_:2},1024))),128))]),_:1},8,["modelValue","finished"])])])]),(0,l.bF)(o.A,{ref_key:"blockchainRef",ref:$,config:Y,onWalletConnected:z,onContractReady:G,onTxSuccess:J,onError:P},null,8,["config"])],64)}}}),S=t(6262);const A=(0,S.A)(I,[["__scopeId","data-v-5e175742"]]);var E=A}}]);